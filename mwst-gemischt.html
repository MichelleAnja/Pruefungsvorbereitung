<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interaktives Formular – Gemischte Verwendung</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: url("hintergrund.jpg") no-repeat center center fixed;
      background-size: cover;
      margin: 0;
      padding: 40px 20px;
      color: black;
    }
    .section {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 40px;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }
    h2 {
      font-size: 18px;
      margin-bottom: 16px;
      font-weight: normal;
    }
    .options {
      margin-bottom: 10px;
    }
    .options button {
      margin: 5px;
      padding: 10px 16px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      background-color: black;
      color: white;
    }
    .options input[type="text"] {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-bottom: 10px;
    }
    .options .submit-btn {
      margin-top: 5px;
      background-color: #333;
    }
    .correct {
      background-color: lightgreen !important;
      color: black !important;
    }
    .wrong {
      background-color: lightcoral !important;
      color: black !important;
    }
    .explanation {
      margin-top: 10px;
      font-weight: bold;
      display: none;
    }
    .back-link {
      display: inline-block;
      margin-bottom: 20px;
      font-size: 18px;
      font-weight: bold;
      color: black;
      text-decoration: none;
    }
  </style>
</head>
<body>
<a class="back-link" href="mwst.html">← Zurück</a>
<h2 style="text-align:center">Gemischte Verwendung</h2>
<div id="form"></div>

<script>
const questions = [
  {
    q: "1. Was wird hier beschrieben?\nEs liegt dann vor, wenn bezogene Leistungen wechselnd sowohl für ihre unternehmerische als auch für nicht unternehmerische (oder von der MWST-ausgenommenen) Tätigkeiten verwendet werden.",
    options: ["Gemischte Verwendung", "Vorübergehende Verwendung"],
    correct: "Gemischte Verwendung"
  },
  {
    q: "2. Was wird hier beschrieben?\nEs liegt dann vor, wenn die steuerpflichtige Person Leistungen vorübergehend (während max. 6 Monaten oder bei unbeweglichen Gegenständen 12 Monaten) ausschliesslich für einen nicht zum Vorsteuerabzug berechtigende (Eigenverbrauch) bzw. für eine zum Vorsteuerberechtigte (Einlageentsteuerung) Tätigkeit verwendet.",
    options: ["Gemischte Verwendung", "Vorübergehende Verwendung"],
    correct: "Vorübergehende Verwendung"
  },
  {
    q: "3. Ab wann muss bei Nebentätigkeiten wie z.B. Bankzinsen eine Vorsteuerkorrektur gemacht werden (Art. 66 MWSTV)?",
    type: "text",
    correct: "- Umsatz der Nebentätigkeit von CHF 10’000\n- 5% des Gesamtumsatzes"
  },
  {
    q: "4. Wie hoch ist die Vorsteuerkorrektur bei solchen Nebentätigkeiten?",
    type: "text",
    correct: "Pauschal mit 0.02% des Ertrags aus Nebentätigkeiten."
  }
];

const container = document.getElementById("form");
questions.forEach((item, index) => {
  const section = document.createElement("div");
  section.className = "section";
  const id = `feedback${index+1}`;

  const title = document.createElement("h2");
  title.innerText = item.q;
  section.appendChild(title);

  const feedback = document.createElement("div");
  feedback.id = id;
  feedback.className = "explanation";

  const optionsDiv = document.createElement("div");
  optionsDiv.className = "options";

  if (item.options) {
    item.options.forEach(opt => {
      const button = document.createElement("button");
      button.innerText = opt;
      button.addEventListener("click", () => handleChoice(button, opt, item.correct, id, item.extra));
      optionsDiv.appendChild(button);
    });
  } else {
    const input = document.createElement("input");
    input.type = "text";
    input.placeholder = "Antwort eingeben";
    input.id = `input${index}`;

    const btn = document.createElement("button");
    btn.innerText = "OK";
    btn.className = "submit-btn";
    btn.addEventListener("click", () => checkInput(input, item.correct, id, item.extra));

    optionsDiv.appendChild(input);
    optionsDiv.appendChild(btn);
  }

  section.appendChild(optionsDiv);
  section.appendChild(feedback);
  container.appendChild(section);
});

function handleChoice(button, chosen, correct, feedbackId, extraText) {
  const buttons = button.parentElement.querySelectorAll("button");
  buttons.forEach(btn => btn.disabled = true);
  const feedback = document.getElementById(feedbackId);
  feedback.style.display = "block";
  if (chosen.toLowerCase() === correct.toLowerCase()) {
    button.classList.add("correct");
    feedback.innerHTML = `Richtig! ✅<br>${extraText || ''}`;
    feedback.style.color = 'green';
  } else {
    button.classList.add("wrong");
    feedback.innerHTML = `Falsch ❌ – Richtige Antwort: ${correct}<br>${extraText || ''}`;
    feedback.style.color = 'red';
  }
}

function normalize(text) {
  return text.trim().toLowerCase().replace(/[.,!\-\n’]/g, '').replace(/\s+/g, ' ');
}

function checkInput(input, correctAnswer, feedbackId, extraText) {
  const feedback = document.getElementById(feedbackId);
  feedback.style.display = 'block';
  const userAnswer = normalize(input.value);
  const correct = normalize(correctAnswer);
  if (userAnswer === correct) {
    input.classList.add('correct');
    feedback.innerHTML = `Richtig! ✅<br>${extraText || ''}`;
    feedback.style.color = 'green';
  } else {
    input.classList.add('wrong');
    feedback.innerHTML = `Falsch ❌ – Richtige Antwort: ${correctAnswer}<br>${extraText || ''}`;
    feedback.style.color = 'red';
  }
  input.disabled = true;
}
</script>
</body>
</html>
